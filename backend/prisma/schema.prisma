// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Account {
  primarykey String    @id @default(uuid()) @map("primarykey") // UUID как primary key
  login      String    @unique
  email      String    @unique
  password   String
  firstName  String    @map("firstname")
  lastName   String    @map("lastname")
  role       String?
  roleRef    role?      @relation("accountRole", fields: [role], references: [primarykey]) // Связать с role
  createTime DateTime  @default(now()) @map("createtime")
  editTime   DateTime  @default(now()) @updatedAt @map("edittime")
  avatarUrl  String?   @map("avatarurl")
  status     String?
  creator    String?
  creatorRef role?      @relation("accountCreator", fields: [creator], references: [primarykey])

  @@map("accounts") // Указываем, что таблица называется "accounts"
  @@index([email], name: "idx_accounts_email") // Индекс для email
  @@index([login], name: "idx_accounts_login") // Индекс для login
}

model role {
  primarykey String    @id @default(uuid()) @map("primarykey") // UUID как primary key
  name String
  createTime DateTime  @default(now()) @map("createtime")
  editTime   DateTime  @default(now()) @updatedAt @map("edittime")

  role Account[]       @relation("accountRole")
  creator Account[]    @relation("accountCreator")
}